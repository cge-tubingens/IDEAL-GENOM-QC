<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VariantQC &mdash; ideal-genome-qc 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=01f34227"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Helpers" href="Helpers.html" />
    <link rel="prev" title="Population Structure" href="PopStructure.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            ideal-genome-qc
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="SampleQC.html">SampleQC</a></li>
<li class="toctree-l1"><a class="reference internal" href="AncestryQC.html">AncestryQC</a></li>
<li class="toctree-l1"><a class="reference internal" href="PopStructure.html">Population Structure</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">VariantQC</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#ideal_genom_qc.VariantQC.VariantQC"><code class="docutils literal notranslate"><span class="pre">VariantQC</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#ideal_genom_qc.VariantQC.VariantQC.execute_different_genotype_call_rate"><code class="docutils literal notranslate"><span class="pre">VariantQC.execute_different_genotype_call_rate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ideal_genom_qc.VariantQC.VariantQC.execute_drop_variants"><code class="docutils literal notranslate"><span class="pre">VariantQC.execute_drop_variants()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ideal_genom_qc.VariantQC.VariantQC.execute_hwe_test"><code class="docutils literal notranslate"><span class="pre">VariantQC.execute_hwe_test()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ideal_genom_qc.VariantQC.VariantQC.execute_missing_data_rate"><code class="docutils literal notranslate"><span class="pre">VariantQC.execute_missing_data_rate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ideal_genom_qc.VariantQC.VariantQC.get_fail_variants"><code class="docutils literal notranslate"><span class="pre">VariantQC.get_fail_variants()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ideal_genom_qc.VariantQC.VariantQC.report_different_genotype_call_rate"><code class="docutils literal notranslate"><span class="pre">VariantQC.report_different_genotype_call_rate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ideal_genom_qc.VariantQC.VariantQC.report_hwe"><code class="docutils literal notranslate"><span class="pre">VariantQC.report_hwe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#ideal_genom_qc.VariantQC.VariantQC.report_missing_data"><code class="docutils literal notranslate"><span class="pre">VariantQC.report_missing_data()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Helpers.html">Helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_references.html">Get References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ideal-genome-qc</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">VariantQC</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/VariantQC.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-ideal_genom_qc.VariantQC">
<span id="variantqc"></span><h1>VariantQC<a class="headerlink" href="#module-ideal_genom_qc.VariantQC" title="Link to this heading"></a></h1>
<p>Python module to perform variant quality control</p>
<dl class="py class">
<dt class="sig sig-object py" id="ideal_genom_qc.VariantQC.VariantQC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">ideal_genom_qc.VariantQC.</span></span><span class="sig-name descname"><span class="pre">VariantQC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#ideal_genom_qc.VariantQC.VariantQC" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="ideal_genom_qc.VariantQC.VariantQC.execute_different_genotype_call_rate">
<span class="sig-name descname"><span class="pre">execute_different_genotype_call_rate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ideal_genom_qc.VariantQC.VariantQC.execute_different_genotype_call_rate" title="Link to this definition"></a></dt>
<dd><p>Execute test for different genotype call rates between cases and controls using PLINK.</p>
<p>This method performs the following operations:
1. Calculates available memory for PLINK execution
2. Runs PLINK’s –test-missing command to identify markers with significantly different
missing rates between cases and controls
3. Generates a .missing file with the results</p>
<p>The method uses approximately 2/3 of available system memory for PLINK execution.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Creates a .missing file in the results directory</p></li>
<li><p>Sets self.case_control_missing path attribute</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ideal_genom_qc.VariantQC.VariantQC.execute_drop_variants">
<span class="sig-name descname"><span class="pre">execute_drop_variants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">maf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geno</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hwe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5e-08</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ideal_genom_qc.VariantQC.VariantQC.execute_drop_variants" title="Link to this definition"></a></dt>
<dd><p>Execute variant filtering based on quality control parameters using PLINK.</p>
<p>This method removes variants that fail quality control criteria including minor allele frequency (MAF),
genotype missingness rate, and Hardy-Weinberg equilibrium (HWE) test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maf</strong> (<em>float</em><em>, </em><em>optional</em>) – Minor allele frequency threshold. Variants with MAF below this value are removed.
Default is 5e-8.</p></li>
<li><p><strong>geno</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum per-variant missing genotype rate. Variants with missing rate above this
value are removed. Default is 0.1 (10%).</p></li>
<li><p><strong>hwe</strong> (<em>float</em><em>, </em><em>optional</em>) – Hardy-Weinberg equilibrium test p-value threshold. Variants with HWE p-value below
this are removed. Default is 5e-8.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Creates quality controlled PLINK binary files (.bed, .bim, .fam) in the clean directory
with suffix ‘-variantQCed’.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ideal_genom_qc.VariantQC.VariantQC.execute_hwe_test">
<span class="sig-name descname"><span class="pre">execute_hwe_test</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ideal_genom_qc.VariantQC.VariantQC.execute_hwe_test" title="Link to this definition"></a></dt>
<dd><p>Execute Hardy-Weinberg Equilibrium (HWE) test using PLINK.</p>
<p>This method performs the following steps:
1. Calculates available memory and allocates 2/3 for the test
2. Runs PLINK command to compute HWE test on the input binary PLINK files
3. Saves results to a .hwe output file</p>
<p>The HWE test is used to assess whether genotype frequencies in a population remain constant
across generations under specific conditions.</p>
<section id="returns">
<h2>Returns:<a class="headerlink" href="#returns" title="Link to this heading"></a></h2>
<blockquote>
<div><p>None</p>
</div></blockquote>
</section>
<section id="side-effects">
<h2>Side effects:<a class="headerlink" href="#side-effects" title="Link to this heading"></a></h2>
<blockquote>
<div><ul class="simple">
<li><p>Creates a .hwe output file in the results directory</p></li>
<li><p>Sets self.hwe_results to the name of the output file</p></li>
</ul>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ideal_genom_qc.VariantQC.VariantQC.execute_missing_data_rate">
<span class="sig-name descname"><span class="pre">execute_missing_data_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chr_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">24</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#ideal_genom_qc.VariantQC.VariantQC.execute_missing_data_rate" title="Link to this definition"></a></dt>
<dd><p>Executes missing data rate analysis using PLINK for male and female subjects separately.
This method performs two PLINK operations:
1. Generates .lmiss and .imiss files for male subjects on chromosome Y
2. Generates .lmiss and .imiss files for all subjects excluding chromosome Y</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>chr_y</strong> (<em>int</em><em>, </em><em>default=24</em>) – Chromosome Y number in the dataset. Must be between 0 and 26.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TypeError</strong> – If chr_y is not an integer</p></li>
<li><p><strong>ValueError</strong> – If chr_y is not between 0 and 26</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method uses 2/3 of available system memory for PLINK operations.
Output files are generated in the results directory with the following naming pattern:
- {output_name}-missing-males-only.lmiss/.imiss : For male subjects
- {output_name}-missing-not-y.lmiss/.imiss : For non-Y chromosome data
The results are stored in self.males_missing_data and self.females_missing_data as Path objects.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ideal_genom_qc.VariantQC.VariantQC.get_fail_variants">
<span class="sig-name descname"><span class="pre">get_fail_variants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">marker_call_rate_thres</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">case_controls_thres</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hwe_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">male_female_y_cap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hwe_y_cap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ideal_genom_qc.VariantQC.VariantQC.get_fail_variants" title="Link to this definition"></a></dt>
<dd><p>Identify and consolidate failing variants based on multiple quality control criteria.
This method combines the results of three QC checks:
1. Variants with high missing data rates
2. Variants with significantly different genotype call rates between cases and controls
3. Variants failing Hardy-Weinberg equilibrium test</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>marker_call_rate_thres</strong> (<em>float</em><em>, </em><em>optional</em>) – Threshold for failing variants based on missing data rate (default: 0.2)</p></li>
<li><p><strong>case_controls_thres</strong> (<em>float</em><em>, </em><em>optional</em>) – P-value threshold for differential missingness between cases and controls (default: 1e-5)</p></li>
<li><p><strong>hwe_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – P-value threshold for Hardy-Weinberg equilibrium test (default: 5e-8)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A summary DataFrame containing:
- Counts of variants failing each QC criterion
- Number of variants failing multiple criteria (duplicates)
- Total number of unique failing variants</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Results are also written to a tab-separated file ‘fail_markers.txt’</p></li>
<li><p>Variants failing multiple criteria are only counted once in the final output file</p></li>
</ul>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ideal_genom_qc.VariantQC.VariantQC.report_different_genotype_call_rate">
<span class="sig-name descname"><span class="pre">report_different_genotype_call_rate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ideal_genom_qc.VariantQC.VariantQC.report_different_genotype_call_rate" title="Link to this definition"></a></dt>
<dd><p>Reports markers with different genotype call rates based on a given threshold.
This function reads a .missing file, filters markers with a different genotype call rate
below the specified threshold, and returns a DataFrame containing these markers.</p>
<section id="parameters">
<h2>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading"></a></h2>
<blockquote>
<div><p>directory (str): The directory where the .missing file is located.
filename (str): The name of the .missing file.
threshold (float): The threshold for filtering markers based on the P-value.</p>
</div></blockquote>
</section>
<section id="id1">
<h2>Returns:<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<blockquote>
<div><dl class="simple">
<dt>pd.DataFrame: A DataFrame containing markers with different genotype call rates</dt><dd><p>below the specified threshold. The DataFrame has two columns:
‘SNP’ and ‘Failure’, where ‘Failure’ is set to ‘Different genotype call rate’.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ideal_genom_qc.VariantQC.VariantQC.report_hwe">
<span class="sig-name descname"><span class="pre">report_hwe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hwe_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_lim_cap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ideal_genom_qc.VariantQC.VariantQC.report_hwe" title="Link to this definition"></a></dt>
<dd><p>Generate Hardy-Weinberg Equilibrium (HWE) test report and visualization.</p>
<p>This method reads HWE test results from a file, identifies variants that fail HWE,
creates a histogram of -log10(P) values, and returns failed variants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> (<em>Path</em>) – Directory path where the HWE test results file is located</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the file containing HWE test results</p></li>
<li><p><strong>hwe_threshold</strong> (<em>float</em><em>, </em><em>optional</em>) – P-value threshold for HWE test failure (default: 5e-8)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing variants that failed HWE test with columns:
- SNP: variant identifier
- Failure: reason for failure (always ‘HWE’)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method creates a histogram plot saved as ‘hwe-histogram’ showing the
distribution of -log10(P) values from HWE tests.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="ideal_genom_qc.VariantQC.VariantQC.report_missing_data">
<span class="sig-name descname"><span class="pre">report_missing_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename_male</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename_female</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_axis_cap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="headerlink" href="#ideal_genom_qc.VariantQC.VariantQC.report_missing_data" title="Link to this definition"></a></dt>
<dd><p>Analyze and report missing data rates for male and female subjects.
This method processes missing data information from separate files for male and female subjects,
creates visualizations of missing data distributions, and identifies SNPs that fail the missing
data threshold for each sex group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>directory</strong> (<em>str</em>) – Path to the directory containing the input files</p></li>
<li><p><strong>filename_male</strong> (<em>str</em>) – Name of the file containing missing data information for male subjects (.lmiss format)</p></li>
<li><p><strong>filename_female</strong> (<em>str</em>) – Name of the file containing missing data information for female subjects (.lmiss format)</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Maximum allowed missing data rate (between 0 and 1)</p></li>
<li><p><strong>y_axis_cap</strong> (<em>int</em><em>, </em><em>optional</em>) – Upper limit for y-axis in histogram plots (default is 10)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing SNPs that fail the missing data threshold for either sex,
with columns [‘SNP’, ‘Failure’] where ‘Failure’ indicates the failing category</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The method generates two histogram plots saved as ‘missing_data_male’ and
‘missing_data_female’ showing the distribution of missing data rates for each sex.</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="PopStructure.html" class="btn btn-neutral float-left" title="Population Structure" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Helpers.html" class="btn btn-neutral float-right" title="Helpers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Luis Giraldo Gonzalez Ricardo, Amabel Tenghe, and Ashwin Ashok Kumar Sreelatha.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>